# JUnit Reporter for Mocha with modifications for XRay

Produces JUnit-style XML test results. This module is a copied and slightly modified version of mocha-junit-reporter version 2.0.0
It does the same as mocha-junit-xray with the only difference that is adds the first word of the text of any describe-section in the mocha test script as the value for the requirement parameter in the result file. The reason for this is related to how XRay imports JUnit XML results: Whenever you import a JUnit XML result file into XRay, for example
via Jira/XRay REST API, XRay automatically creates tests for the imported results, if it does not find any matching test. But because JUnit XML result file generated by the
original mocha-junit-reporter does not have any information about the requirement/story to which the corresponding test results belong, XRay generates tests without any links to the corresponding requirements/stories. 
However as explaned in its documentation, XRay has the capability to import the requrement/story information too, IF it is provided, which is not the case for the module mocha-junit-reporter version 2.0.0:

https://docs.getxray.app/display/XRAYCLOUD/Taking+advantage+of+JUnit+XML+reports

So what this modified module does, is that it simply add the requirement/story information to the JUnit XML result file. The requirement/story information is passed as the first word in a describe-section.

For example if you have a test script with the following test case:

const assert = require('chai').assert;
describe('REQ-12345 Mussfeld f√ºr die Email-Adresse', function(){
    it('Mussfeld ist deaktiviert', function(){
        assert.equal(1, 1);
    })
});

The JUnit-XML-result file generated by this module will look as follows:

<?xml version="1.0" encoding="UTF-8"?>
<testsuites name="Mocha Tests" time="0.0010" tests="1" failures="0">
  <testsuite name="Root Suite" timestamp="2021-06-08T13:20:39" tests="0" time="0.0000" failures="0">
  </testsuite>
  <testsuite name="REQ-12345 User login test" timestamp="2021-06-08T13:20:39" tests="1" file="C:\Temp\app.js" time="0.0010" failures="0">
    <testcase name="REQ-12345 User login test Wrong password" time="0.0010" classname="Mussfeld ist deaktiviert" requirement="REQ-12345">
    </testcase>
  </testsuite>
</testsuites>

Of course this is only a workaround. But this approach (writing your own customer reporter or modifying an existing one for XRay is currently the recommended solution according to XRay support team).

## Installation

```shell
$ npm install mocha-junit-xray-reporter --save-dev
```

or as a global module
```shell
$ npm install -g mocha-junit-xray-reporter
```

## Usage
Run mocha with `mocha-junit-xray-reporter`:

```shell
$ mocha test --reporter mocha-junit-xray-reporter
```
This will output a results file at `./test-results.xml`.

For more information refer to the documentation of mocha-JUnit-reporter version 2.0.0 module from which this module was copied and slighty modified.